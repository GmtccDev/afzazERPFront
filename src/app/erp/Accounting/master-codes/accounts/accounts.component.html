<ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#fff" type="ball-scale-multiple" [fullScreen]="true">
	<p style="color: white ;font-size: 20px;"> {{'general.loading'|translate}}... </p>
</ngx-spinner>
<div class="search-bar">
	<input type="text" class="form-control icon-branch" [(ngModel)]="codeSearchText" placeholder=" {{'general.code'|translate}}">
	<input type="text" class="form-control icon-branch" [(ngModel)]="nameSearchText" placeholder="{{'general.name'|translate}}">
	<input type="text" class="form-control icon-branch" [(ngModel)]="levelSearchText" (keyup)="onKeyUp($event)" placeholder="{{'general.level'|translate}}">
	<button nz-button nzType="primary" (click)="searchData()">{{'general.search'|translate}}</button>
</div>
<button nz-button nzType="primary" (click)="expandAllRows()">
	{{ 'general.all' | translate }}
</button>

<nz-table #expandTable [nzBordered]="true" [nzData]="listOfMapData" nzTableLayout="fixed" class="table table-broder">
	<thead>
		<tr>
			<th> {{'general.code'|translate}}</th>
			<th> {{'general.nameAr'|translate}}</th>
			<th> {{'general.nameEn'|translate}}</th>
			<th> {{'general.level'|translate}}</th>
			<th><span *ngIf="lang=='ar'"> رئيسي</span>
				<span *ngIf="lang!=='ar'">{{'general.parent'|translate}}</span>
			</th>

			<th> {{'account.accountType'|translate}}</th>
			<th>{{'general.actions'|translate}}</th>
		</tr>
	</thead>
	<tbody>
		<ng-container *ngFor="let data of expandTable.data">
			<ng-container *ngFor="let item of mapOfExpandedData[data.treeId]">
				<tr *ngIf="(item.parent && item.parent.expanded) || !item.parent">
					<td [nzIndentSize]="item.levelId! * 20" [nzShowExpand]="!!item.children"
						[(nzExpand)]="item.expanded"
						(nzExpandChange)="collapse(mapOfExpandedData[data.treeId], item, $event)">
						{{ item.code }}

					</td>
					<td>{{ item.nameAr }}</td>
					<td>{{ item.nameEn }}</td>
					<td>{{ item.levelId+1 }}</td>
					<td>
						<span *ngIf="!item.isLeafAccount" class="markTrue">✓</span>
						<span *ngIf="item.isLeafAccount" class="markFalse">✘</span>
					</td>
					<td>
						<span *ngIf="item.accountType==1&&lang=='ar'">قائمة الدخل</span>
						<span *ngIf="item.accountType==2&&lang=='ar'">الميزانية</span>
						<span *ngIf="item.accountType==1&&lang!=='ar'">Income Statement </span>
						<span *ngIf="item.accountType==2&&lang!=='ar'">Budget</span>
					</td>
					<td class="d-flex gap-2">
						<button nz-button nzType="primary"
							(click)="addNode(item.id)">{{'toolbar.new'|translate}}</button>
						<button nz-button nzType="default" (click)="onEdit(item.id)" class="btn-secondary">
							{{'buttons.edit'|translate}}</button>
						<button nz-button nzType="danger" (click)="showConfirmDeleteMessage(item.id)"
							[disabled]="!item.isLeafAccount" class="btn-danger">
							{{'buttons.delete'|translate}}</button>
					</td>

				</tr>
			</ng-container>
		</ng-container>
	</tbody>
</nz-table>